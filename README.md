# AgentFlow-FE

é«˜æ€§èƒ½è‡ªå®šä¹‰ React SSRï¼ˆæœåŠ¡ç«¯æ¸²æŸ“ï¼‰æ¡†æ¶

## ğŸš€ é¡¹ç›®æ¦‚è¿°

AgentFlow-FE æ˜¯ä¸€ä¸ªä¸“ä¸ºå¤§å‹åº”ç”¨åœºæ™¯è®¾è®¡çš„é«˜æ€§èƒ½ã€é«˜åº¦å¯å®šåˆ¶çš„æœåŠ¡ç«¯æ¸²æŸ“æ¡†æ¶ï¼Œå…·æœ‰ä»¥ä¸‹æ ¸å¿ƒæ€§èƒ½æŒ‡æ ‡ï¼š

- **å“åº”æ—¶é—´**ï¼š40-60msï¼ˆç›¸æ¯” Next.js çš„ 100-150msï¼‰
- **å†·å¯åŠ¨**ï¼š800msï¼ˆç›¸æ¯” Next.js çš„ 4-5sï¼‰  
- **é«˜å¹¶å‘**ï¼šæ”¯æŒ 10W+ QPS

## ğŸ“¦ æŠ€æœ¯æ ˆ

### æ ¸å¿ƒè¿è¡Œæ—¶
- React 18.3.1 - UI æ¡†æ¶
- Koa 2.14.1 - æœåŠ¡å™¨æ¡†æ¶
- React Query 4.29.3 - æœåŠ¡ç«¯çŠ¶æ€ç®¡ç†
- React Router DOM 6.10.0 - å®¢æˆ·ç«¯è·¯ç”±

### SSR åŸºç¡€è®¾æ–½
- @loadable/component - ä»£ç åˆ†å‰²
- Styled Components - CSS-in-JS
- Emotion - CSS-in-JS å¼•æ“
- Material-UI - ç»„ä»¶åº“
- React Helmet - SEO å…ƒæ ‡ç­¾ç®¡ç†

### æ„å»ºå·¥å…·
- Webpack 5 - æ¨¡å—æ‰“åŒ…å™¨
- Babel 7 - JavaScript ç¼–è¯‘å™¨
- TypeScript 5 - ç±»å‹å®‰å…¨
- Tailwind CSS 4 - CSS æ¡†æ¶

## ğŸ› ï¸ å¿«é€Ÿå¼€å§‹

### å®‰è£…ä¾èµ–
```bash
npm install
```

### å¼€å‘ç¯å¢ƒ
```bash
# å¯åŠ¨å¼€å‘ç¯å¢ƒï¼ˆwebpack æ„å»ºç›‘å¬ + nodemon æœåŠ¡å™¨ï¼‰
npm run dev

# å¯åŠ¨ Mock API æœåŠ¡å™¨ï¼ˆç«¯å£ 8007ï¼‰
npm run mock

# å¯åŠ¨æ–‡æ¡£æœåŠ¡å™¨
npm run docs
```

### æ„å»º
```bash
# æ„å»ºç”Ÿäº§ç‰ˆæœ¬ï¼ˆçº¿ä¸Šç¯å¢ƒï¼‰
npm run build

# å¤šç¯å¢ƒæ„å»º
npm run build:online  # çº¿ä¸Šç¯å¢ƒ
npm run build:beta    # æµ‹è¯•ç¯å¢ƒ
npm run build:test1   # æµ‹è¯•ç¯å¢ƒ1
```

### ç”Ÿäº§ç¯å¢ƒ
```bash
# ä½¿ç”¨ PM2 å¯åŠ¨ç”Ÿäº§æœåŠ¡å™¨
npm start
```

## ğŸ—ï¸ é¡¹ç›®æ¶æ„

### ç›®å½•ç»“æ„
```
app/
â”œâ”€â”€ client/           # å®¢æˆ·ç«¯å…¥å£å’Œæ°´åˆé€»è¾‘
â”œâ”€â”€ server/           # æœåŠ¡ç«¯æ¸²æŸ“é€»è¾‘
â”‚   â”œâ”€â”€ index.tsx     # ä¸»è¦ SSR æ¸²æŸ“å™¨
â”‚   â”œâ”€â”€ app.tsx       # åº”ç”¨é…ç½®
â”‚   â”œâ”€â”€ html.tsx      # HTML æ¨¡æ¿ç”Ÿæˆ
â”‚   â”œâ”€â”€ server.ts     # æœåŠ¡å™¨å…¥å£
â”‚   â””â”€â”€ serverless.ts # Serverless éƒ¨ç½²
â””â”€â”€ utils/            # å…±äº«å·¥å…·å‡½æ•°

src/
â”œâ”€â”€ pages/            # é¡µé¢ç»„ä»¶
â”œâ”€â”€ components/       # å¯å¤ç”¨ UI ç»„ä»¶
â”œâ”€â”€ routes/           # è·¯ç”±å®šä¹‰å’Œæ‡’åŠ è½½
â”œâ”€â”€ apis/             # API æœåŠ¡å’Œæ•°æ®è·å–
â”œâ”€â”€ types/            # TypeScript ç±»å‹å®šä¹‰
â””â”€â”€ theme/            # ä¸»é¢˜å’Œæ ·å¼é…ç½®

config/
â”œâ”€â”€ webpack.config.js # åŸºç¡€ webpack é…ç½®
â”œâ”€â”€ webpack.dev.js    # å¼€å‘ç¯å¢ƒé…ç½®
â”œâ”€â”€ webpack.prod.js   # ç”Ÿäº§ç¯å¢ƒé…ç½®
â””â”€â”€ env/              # ç¯å¢ƒç‰¹å®šé…ç½®
```

### åŒé‡æ„å»ºç³»ç»Ÿ
- **å®¢æˆ·ç«¯æ„å»º**ï¼šæµè§ˆå™¨ç«¯çš„ JavaScript å’Œ CSS åŒ…
- **æœåŠ¡ç«¯æ„å»º**ï¼šNode.js æœåŠ¡å™¨ç«¯ä»£ç 
- ä½¿ç”¨ Webpack å¤šé…ç½®å®ç°çœŸæ­£çš„åŒæ„æ¸²æŸ“

### SSR æµç¨‹
```
è·¯ç”±åŒ¹é… â†’ æ•°æ®é¢„å– â†’ ç»„ä»¶æ¸²æŸ“ â†’ HTML ç”Ÿæˆ â†’ å®¢æˆ·ç«¯æ°´åˆ
```

## ğŸ¯ æ ¸å¿ƒç‰¹æ€§

### æ€§èƒ½ä¼˜åŒ–
- **åŒ…ä¼˜åŒ–**ï¼šThread-loader å¹¶è¡Œå¤„ç†ã€Webpack æ–‡ä»¶ç³»ç»Ÿç¼“å­˜
- **è¿è¡Œæ—¶ä¼˜åŒ–**ï¼šå…³é”® CSS æå–ã€è·¯ç”±çº§ä»£ç åˆ†å‰²
- **æ ·å¼å¤„ç†**ï¼šStyled Components æ ·å¼æ”¶é›†ã€Emotion å…³é”® CSS æå–

### ä»£ç åˆ†å‰²
- ä½¿ç”¨ `@loadable/component` è¿›è¡Œè·¯ç”±çº§ä»£ç åˆ†å‰²
- Webpack è‡ªåŠ¨ç”Ÿæˆ chunk
- SSR chunk æ”¶é›†å’Œ Loadable ç»Ÿè®¡ä¿¡æ¯ç”Ÿæˆ

### çƒ­æ¨¡å—æ›¿æ¢ (HMR)
- React ç»„ä»¶çƒ­é‡è½½
- Webpack Dev Server é›†æˆ
- æœåŠ¡å™¨ç«¯ä»£ç è‡ªåŠ¨é‡å¯

## ğŸ”§ è·¯å¾„åˆ«å

é¡¹ç›®é…ç½®äº†ä»¥ä¸‹è·¯å¾„åˆ«åä»¥å®ç°æ¸…æ™°çš„å¯¼å…¥ï¼š

```typescript
"@app/*" â†’ "app/*"
"@/*" â†’ "src/*"
"@components/*" â†’ "src/components/*"
"@pages/*" â†’ "src/pages/*"
"@utils/*" â†’ "src/utils/*"
"@apis/*" â†’ "src/apis/*"
"@types/*" â†’ "src/types/*"
```

## ğŸ¨ æ ·å¼æ¶æ„

æ”¯æŒå¤šç§æ ·å¼è§£å†³æ–¹æ¡ˆï¼š

- **MUI ç»„ä»¶**ï¼šMaterial-UI ç»„ä»¶åº“ï¼Œé’ˆå¯¹ SSR ä¼˜åŒ–
- **Emotion**ï¼šCSS-in-JSï¼ŒæœåŠ¡ç«¯å…³é”® CSS æå–
- **Styled Components**ï¼šç»„ä»¶çº§æ ·å¼ï¼Œæ”¯æŒ SSR
- **Tailwind CSS**ï¼šå®ç”¨ä¼˜å…ˆçš„ CSS æ¡†æ¶
- **LESS**ï¼šé¢„å¤„ç†å™¨ï¼Œæ”¯æŒ CSS æ¨¡å—

## ğŸ§ª æµ‹è¯•å’Œè´¨é‡ä¿è¯

### å¯ç”¨è„šæœ¬
- **ESLint**ï¼šä»£ç æ£€æŸ¥ï¼ŒåŒ…å« React ç‰¹å®šè§„åˆ™
- **TypeScript**ï¼šç±»å‹æ£€æŸ¥
- **Prettier**ï¼šä»£ç æ ¼å¼åŒ–

### Mock æ•°æ®
- JSON Server ç”¨äº API æ¨¡æ‹Ÿï¼ˆ`npm run mock`ï¼‰
- Mock æ•°æ®ä½äº `mocks/data.json`

## ğŸš€ éƒ¨ç½²æ–¹å¼

### æ”¯æŒçš„éƒ¨ç½²é€‰é¡¹
1. **ä¼ ç»ŸæœåŠ¡å™¨**ï¼šPM2 è¿›ç¨‹ç®¡ç†
2. **Serverless**ï¼šAWS Lambda æ”¯æŒ
3. **å®¹å™¨åŒ–**ï¼šDocker å°±ç»ªé…ç½®

### ç”Ÿäº§ä¼˜åŒ–
- Webpack ç”Ÿäº§ä¼˜åŒ–
- CSS æå–å’Œå‹ç¼©
- Tree shaking å’Œæ­»ä»£ç æ¶ˆé™¤
- èµ„æºä¼˜åŒ–ï¼ˆå›¾ç‰‡ã€å­—ä½“ï¼‰

## ğŸŒ å¤šç¯å¢ƒæ”¯æŒ

æ”¯æŒå¤šç§ç¯å¢ƒé…ç½®ï¼š
- `local` - æœ¬åœ°å¼€å‘
- `test` - æµ‹è¯•ç¯å¢ƒ
- `beta` - é¢„å‘å¸ƒç¯å¢ƒ
- `online` - ç”Ÿäº§ç¯å¢ƒ

## âš ï¸ é‡è¦è¯´æ˜

### SSR ç‰¹å®šè€ƒè™‘
- æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯ä½¿ç”¨ç‹¬ç«‹çš„ webpack é…ç½®
- Emotion ç¼“å­˜åºåˆ—åŒ–é˜²æ­¢ FOUCï¼ˆæ— æ ·å¼å†…å®¹é—ªçƒï¼‰
- LoadablePlugin ä¸ºæœåŠ¡ç«¯ chunk åŠ è½½ç”Ÿæˆæ¸…å•
- SSR å¤±è´¥æ—¶çš„æœåŠ¡é™çº§å›é€€

### ç¯å¢ƒå·®å¼‚
- **å¼€å‘ç¯å¢ƒ**ï¼šä½¿ç”¨ webpack-dev-middleware è¿›è¡Œ HMR
- **ç”Ÿäº§ç¯å¢ƒ**ï¼šä½¿ç”¨é¢„æ„å»ºçš„é™æ€èµ„æº
- **éƒ¨ç½²æ¨¡å¼**ï¼šæœåŠ¡å™¨å’Œ serverless ä½¿ç”¨ä¸åŒå…¥å£ç‚¹

## ğŸ“„ è®¸å¯è¯

[æ·»åŠ è®¸å¯è¯ä¿¡æ¯]

## ğŸ¤ è´¡çŒ®

[æ·»åŠ è´¡çŒ®æŒ‡å—]

---

AgentFlow-FE æ˜¯ä¸€ä¸ªå¤æ‚çš„ SSR æ¡†æ¶ï¼Œä¼˜å…ˆè€ƒè™‘æ€§èƒ½å’Œå®šåˆ¶åŒ–ï¼Œé€‚åˆéœ€è¦å¯¹æ¸²æŸ“è¡Œä¸ºè¿›è¡Œç²¾ç»†æ§åˆ¶çš„å¤§å‹ç”Ÿäº§åº”ç”¨ã€‚
